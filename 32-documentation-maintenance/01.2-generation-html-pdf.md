üîù Retour au [Sommaire](/SOMMAIRE.md)

# 32.1.2 G√©n√©ration HTML/PDF

## Introduction

Maintenant que vous savez √©crire des commentaires Doxygen (voir section 32.1.1), il est temps de **g√©n√©rer** la documentation ! Doxygen va lire votre code source, extraire tous les commentaires sp√©ciaux, et produire une belle documentation navigable au format HTML ou PDF.

Dans cette section, nous allons voir :
- Comment installer Doxygen
- Comment configurer un projet pour la g√©n√©ration
- Comment g√©n√©rer la documentation HTML (le format le plus utilis√©)
- Comment g√©n√©rer la documentation PDF
- Comment personnaliser l'apparence

---

## Installation de Doxygen

### Sur Ubuntu/Debian

```bash
sudo apt update
sudo apt install doxygen
```

Pour la g√©n√©ration PDF, vous aurez √©galement besoin de LaTeX :

```bash
sudo apt install doxygen texlive-latex-base texlive-latex-extra
```

### Sur autres distributions Linux

**Fedora/RHEL/CentOS :**
```bash
sudo dnf install doxygen
sudo dnf install texlive-scheme-basic  # Pour PDF
```

**Arch Linux :**
```bash
sudo pacman -S doxygen
sudo pacman -S texlive-core  # Pour PDF
```

### V√©rifier l'installation

```bash
doxygen --version
```

Vous devriez voir quelque chose comme :
```
1.9.8
```

---

## Structure d'un projet avec Doxygen

Avant de g√©n√©rer la documentation, organisons notre projet. Voici une structure typique :

```
mon-projet/
‚îú‚îÄ‚îÄ src/                    # Code source
‚îÇ   ‚îú‚îÄ‚îÄ main.c
‚îÇ   ‚îú‚îÄ‚îÄ utils.c
‚îÇ   ‚îî‚îÄ‚îÄ utils.h
‚îú‚îÄ‚îÄ include/                # Fichiers d'en-t√™te publics
‚îÇ   ‚îî‚îÄ‚îÄ mon_api.h
‚îú‚îÄ‚îÄ docs/                   # Documentation g√©n√©r√©e (√† cr√©er)
‚îÇ   ‚îî‚îÄ‚îÄ .gitkeep
‚îú‚îÄ‚îÄ Doxyfile               # Fichier de configuration Doxygen
‚îî‚îÄ‚îÄ README.md
```

**Note importante** : Le dossier `docs/` sera cr√©√© automatiquement par Doxygen, vous n'avez pas besoin de le cr√©er manuellement.

---

## Cr√©ation du fichier de configuration (Doxyfile)

Le fichier `Doxyfile` est le fichier de configuration qui indique √† Doxygen comment g√©n√©rer votre documentation.

### G√©n√©rer un Doxyfile par d√©faut

Placez-vous √† la racine de votre projet et ex√©cutez :

```bash
doxygen -g
```

Cette commande cr√©e un fichier `Doxyfile` avec toutes les options possibles et leurs valeurs par d√©faut (avec explications).

**Alternative** : Cr√©er un Doxyfile avec un nom personnalis√© :

```bash
doxygen -g mon_config
```

---

## Configuration minimale pour d√©buter

Le `Doxyfile` par d√©faut contient **beaucoup** d'options (plus de 200 lignes !). Voici les param√®tres essentiels √† modifier pour commencer :

### Options de base

Ouvrez le `Doxyfile` avec votre √©diteur pr√©f√©r√© et modifiez les lignes suivantes :

```bash
# Nom de votre projet
PROJECT_NAME           = "Mon Projet C"

# Version du projet
PROJECT_NUMBER         = "1.0.0"

# Description courte
PROJECT_BRIEF          = "Un projet incroyable en C"

# Langue de la documentation (fr ou en)
OUTPUT_LANGUAGE        = French

# R√©pertoire de sortie pour la doc g√©n√©r√©e
OUTPUT_DIRECTORY       = docs

# Encodage des fichiers source
INPUT_ENCODING         = UTF-8
```

### Sp√©cifier les fichiers √† documenter

Indiquez √† Doxygen o√π trouver votre code source :

```bash
# R√©pertoires contenant le code source
INPUT                  = src/ include/

# Extensions de fichiers √† traiter
FILE_PATTERNS          = *.c *.h

# Parcourir r√©cursivement les sous-r√©pertoires
RECURSIVE              = YES
```

### Contr√¥le de ce qui est document√©

```bash
# Extraire la doc m√™me pour les fonctions sans commentaire Doxygen
EXTRACT_ALL            = YES

# Extraire les fonctions priv√©es (static)
EXTRACT_PRIVATE        = YES

# Extraire les fonctions statiques
EXTRACT_STATIC         = YES

# Inclure le code source dans la doc
SOURCE_BROWSER         = YES

# Num√©ros de ligne dans le code source
INLINE_SOURCES         = NO
```

**Conseil d√©butant** : Mettez `EXTRACT_ALL = YES` au d√©but. Cela documente tout, m√™me ce qui n'a pas de commentaires Doxygen. C'est utile pour d√©couvrir l'outil !

---

## G√©n√©ration de la documentation HTML

### Activer la g√©n√©ration HTML

Dans le `Doxyfile`, v√©rifiez que ces options sont activ√©es (c'est le cas par d√©faut) :

```bash
# G√©n√©rer la documentation HTML
GENERATE_HTML          = YES

# R√©pertoire de sortie HTML (relatif √† OUTPUT_DIRECTORY)
HTML_OUTPUT            = html

# Fichier HTML principal
HTML_FILE_EXTENSION    = .html
```

### G√©n√©rer !

Une fois votre `Doxyfile` configur√©, g√©n√©rez la documentation avec une seule commande :

```bash
doxygen
```

Ou, si votre fichier de config a un nom diff√©rent :

```bash
doxygen mon_config
```

### Ce qui se passe

Doxygen va :
1. Lire tous vos fichiers source sp√©cifi√©s dans `INPUT`
2. Extraire les commentaires Doxygen
3. Analyser la structure du code (fonctions, structures, etc.)
4. G√©n√©rer des fichiers HTML dans `docs/html/`

Vous verrez d√©filer des messages comme :
```
Parsing file src/main.c...
Parsing file src/utils.c...
Parsing file include/utils.h...
Generating docs for function addition...
```

### Visualiser la documentation

Ouvrez le fichier g√©n√©r√© dans votre navigateur :

```bash
# Avec xdg-open (Ubuntu/Debian)
xdg-open docs/html/index.html

# Ou avec Firefox directement
firefox docs/html/index.html

# Ou avec Google Chrome
google-chrome docs/html/index.html
```

Vous devriez voir une page d'accueil avec :
- Une barre de navigation en haut
- Un menu lat√©ral avec les modules, fichiers, fonctions
- Le contenu principal au centre

---

## Navigation dans la documentation HTML g√©n√©r√©e

### Page d'accueil (index.html)

C'est la page principale qui affiche :
- Le nom du projet
- Une description g√©n√©rale (si vous en avez ajout√© une dans le Doxyfile)
- Des liens vers les diff√©rentes sections

### Sections principales

La barre de navigation contient g√©n√©ralement :

- **Main Page** : Page d'accueil
- **Namespaces** : (surtout pour C++, moins pour C)
- **Classes** : Liste des structures (`struct`)
- **Files** : Liste des fichiers source (.c, .h)
- **Functions** : Index alphab√©tique de toutes les fonctions
- **Variables** : Variables globales
- **Macros** : Toutes les `#define`

### Navigation dans une fonction

Cliquez sur une fonction document√©e, vous verrez :
- Sa signature compl√®te
- Description br√®ve et d√©taill√©e
- Liste des param√®tres avec leurs descriptions
- Valeur de retour
- Le code source (si `SOURCE_BROWSER = YES`)
- Les fonctions qui l'appellent et qu'elle appelle (call graph)

---

## G√©n√©ration de la documentation PDF

La g√©n√©ration PDF passe par LaTeX. C'est un peu plus complexe que le HTML, mais le r√©sultat est professionnel.

### Activer la g√©n√©ration LaTeX

Dans le `Doxyfile`, modifiez :

```bash
# G√©n√©rer la documentation LaTeX
GENERATE_LATEX         = YES

# R√©pertoire de sortie LaTeX
LATEX_OUTPUT           = latex

# Format du papier
PAPER_TYPE             = a4

# G√©n√©rer un PDF compact (oui recommand√©)
COMPACT_LATEX          = YES

# Utiliser PDFLaTeX au lieu de LaTeX classique
USE_PDFLATEX           = YES
```

### G√©n√©rer la documentation

Comme pour le HTML :

```bash
doxygen
```

Cette fois, Doxygen g√©n√®re des fichiers LaTeX dans `docs/latex/`.

### Compiler le LaTeX en PDF

**Attention** : Doxygen ne g√©n√®re **pas directement** le PDF. Il cr√©e des fichiers LaTeX que vous devez compiler :

```bash
cd docs/latex
make
```

Le `Makefile` dans `docs/latex/` va compiler les fichiers LaTeX en un PDF nomm√© `refman.pdf` (pour "Reference Manual").

### Visualiser le PDF

```bash
xdg-open docs/latex/refman.pdf
```

Ou copiez-le √† la racine avec un nom plus parlant :

```bash
cp docs/latex/refman.pdf docs/documentation.pdf
```

---

## Probl√®mes courants lors de la g√©n√©ration PDF

### Erreur : "make: command not found"

Installez `build-essential` :

```bash
sudo apt install build-essential
```

### Erreur : "pdflatex: command not found"

Installez le package LaTeX complet :

```bash
sudo apt install texlive-full
```

**Note** : `texlive-full` est gros (plusieurs Go). Si vous voulez √©conomiser de l'espace :

```bash
sudo apt install texlive-latex-base texlive-latex-extra texlive-fonts-recommended
```

### Compilation LaTeX √©choue avec des erreurs

Les erreurs LaTeX peuvent √™tre cryptiques. Solutions courantes :

1. **Caract√®res sp√©ciaux** : Assurez-vous que votre code ne contient pas de caract√®res LaTeX sp√©ciaux mal √©chapp√©s
2. **Noms longs** : Des noms de fonctions tr√®s longs peuvent causer des probl√®mes de mise en page
3. **R√©essayez** : Parfois, lancer `make` deux fois r√©sout le probl√®me (LaTeX a besoin de deux passes)

---

## Personnalisation de la documentation HTML

### Changer le th√®me CSS

Doxygen permet de personnaliser l'apparence HTML.

#### G√©n√©rer le CSS par d√©faut

```bash
doxygen -w html header.html footer.html stylesheet.css
```

Cela cr√©e trois fichiers que vous pouvez modifier :
- `header.html` : En-t√™te de page
- `footer.html` : Pied de page
- `stylesheet.css` : Feuille de style CSS

#### Utiliser votre CSS personnalis√©

Dans le `Doxyfile` :

```bash
HTML_HEADER            = header.html
HTML_FOOTER            = footer.html
HTML_EXTRA_STYLESHEET  = stylesheet.css
```

### Ajouter un logo

Pour afficher votre logo en haut de la doc :

```bash
PROJECT_LOGO           = images/mon_logo.png
```

Placez votre logo dans un dossier `images/` √† la racine du projet.

### Ajouter une page d'accueil personnalis√©e

Cr√©ez un fichier `mainpage.md` √† la racine :

```markdown
# Bienvenue dans Mon Projet C

Ceci est la documentation de mon super projet.

## Fonctionnalit√©s

- Gestion de fichiers
- Traitement de donn√©es
- Interface r√©seau

## D√©marrage rapide

Consultez le fichier [README](README.md) pour compiler le projet.
```

Puis dans le `Doxyfile` :

```bash
USE_MDFILE_AS_MAINPAGE = mainpage.md
INPUT                  += mainpage.md
```

---

## Options avanc√©es du Doxyfile

### Diagrammes et graphes

Doxygen peut g√©n√©rer des diagrammes de d√©pendances entre fichiers et fonctions.

#### Graphes de d√©pendances

```bash
# G√©n√©rer des graphes (n√©cessite Graphviz)
HAVE_DOT               = YES

# Type de graphes √† g√©n√©rer
CALL_GRAPH             = YES    # Qui appelle qui
CALLER_GRAPH           = YES    # Qui est appel√© par qui
INCLUDE_GRAPH          = YES    # D√©pendances d'inclusion
INCLUDED_BY_GRAPH      = YES    # Fichiers qui incluent ce fichier
```

**Installer Graphviz** :

```bash
sudo apt install graphviz
```

Les graphes appara√Ætront sous forme d'images cliquables dans la documentation HTML.

### Optimisation de la taille

Si votre documentation est trop volumineuse :

```bash
# D√©sactiver le code source inline
SOURCE_BROWSER         = NO
INLINE_SOURCES         = NO

# R√©duire la verbosit√©
BRIEF_MEMBER_DESC      = YES
REPEAT_BRIEF           = NO
```

### Exclure des fichiers

Pour ignorer certains fichiers ou r√©pertoires :

```bash
EXCLUDE                = src/tests/ src/deprecated/
EXCLUDE_PATTERNS       = *_old.c *_backup.h
```

---

## G√©n√©ration automatis√©e

### Script bash simple

Cr√©ez un script `generer_doc.sh` :

```bash
#!/bin/bash

echo "G√©n√©ration de la documentation Doxygen..."

# G√©n√©rer HTML et LaTeX
doxygen

# Compiler le PDF
echo "Compilation du PDF..."
cd docs/latex
make
cd ../..

# Copier le PDF √† un endroit accessible
cp docs/latex/refman.pdf docs/documentation.pdf

echo "‚úì Documentation g√©n√©r√©e !"
echo "  HTML : docs/html/index.html"
echo "  PDF  : docs/documentation.pdf"
```

Rendez-le ex√©cutable :

```bash
chmod +x generer_doc.sh
```

Utilisez-le :

```bash
./generer_doc.sh
```

---

## Int√©gration avec Git

### Ignorer les fichiers g√©n√©r√©s

Ajoutez √† votre `.gitignore` :

```gitignore
# Documentation g√©n√©r√©e par Doxygen
docs/html/
docs/latex/
docs/documentation.pdf
```

**Important** : Gardez le `Doxyfile` dans Git, mais pas la documentation g√©n√©r√©e (elle sera recr√©√©e √† chaque fois).

### G√©n√©rer la doc √† chaque commit (optionnel)

Vous pouvez cr√©er un hook Git qui r√©g√©n√®re la doc automatiquement. Cr√©ez `.git/hooks/pre-commit` :

```bash
#!/bin/bash
echo "R√©g√©n√©ration de la documentation..."
doxygen > /dev/null 2>&1
```

Rendez-le ex√©cutable :

```bash
chmod +x .git/hooks/pre-commit
```

---

## H√©bergement de la documentation en ligne

### GitHub Pages

Vous pouvez h√©berger votre documentation HTML gratuitement sur GitHub Pages.

1. G√©n√©rez votre documentation dans `docs/html/`
2. Commitez les fichiers HTML dans votre d√©p√¥t
3. Dans les param√®tres du projet GitHub :
   - Allez dans **Settings** ‚Üí **Pages**
   - S√©lectionnez la branche et le dossier `/docs`
   - Sauvegardez

Votre documentation sera accessible √† l'URL :
```
https://votre-nom.github.io/votre-projet/
```

**Astuce** : Renommez `docs/html/` en `docs/` pour que GitHub Pages le reconnaisse directement.

### Serveur local pour tester

Pour visualiser rapidement votre doc HTML sans ouvrir de fichiers :

```bash
cd docs/html
python3 -m http.server 8000
```

Puis ouvrez http://localhost:8000 dans votre navigateur.

---

## Exemple complet : Configuration d'un petit projet

Imaginons un projet simple avec quelques fichiers. Voici un `Doxyfile` minimal et complet :

```bash
#---------------------------------------------------------------------------
# Configuration de base
#---------------------------------------------------------------------------
PROJECT_NAME           = "Calculatrice Simple"
PROJECT_NUMBER         = "1.0"
PROJECT_BRIEF          = "Une calculatrice en ligne de commande"
OUTPUT_DIRECTORY       = docs
OUTPUT_LANGUAGE        = French

#---------------------------------------------------------------------------
# Entr√©es
#---------------------------------------------------------------------------
INPUT                  = src/ include/
FILE_PATTERNS          = *.c *.h
RECURSIVE              = YES
EXCLUDE_PATTERNS       = */test/*

#---------------------------------------------------------------------------
# Extraction
#---------------------------------------------------------------------------
EXTRACT_ALL            = YES
EXTRACT_PRIVATE        = YES
EXTRACT_STATIC         = YES
SOURCE_BROWSER         = YES

#---------------------------------------------------------------------------
# HTML
#---------------------------------------------------------------------------
GENERATE_HTML          = YES
HTML_OUTPUT            = html
HTML_FILE_EXTENSION    = .html

#---------------------------------------------------------------------------
# LaTeX/PDF
#---------------------------------------------------------------------------
GENERATE_LATEX         = YES
LATEX_OUTPUT           = latex
USE_PDFLATEX           = YES
COMPACT_LATEX          = YES
PAPER_TYPE             = a4

#---------------------------------------------------------------------------
# Graphes (si Graphviz install√©)
#---------------------------------------------------------------------------
HAVE_DOT               = YES
CALL_GRAPH             = YES
CALLER_GRAPH           = YES
```

Sauvegardez ceci dans `Doxyfile`, puis :

```bash
doxygen                          # G√©n√®re HTML et LaTeX
cd docs/latex && make && cd ../.. # Compile le PDF
```

R√©sultat :
- **HTML** : `docs/html/index.html`
- **PDF** : `docs/latex/refman.pdf`

---

## Comparaison HTML vs PDF

| Crit√®re | HTML | PDF |
|---------|------|-----|
| **Navigation** | ‚úÖ Liens cliquables, menu lat√©ral | ‚ùå Table des mati√®res uniquement |
| **Recherche** | ‚úÖ Recherche int√©gr√©e dans le navigateur | ‚úÖ Ctrl+F dans le lecteur PDF |
| **Portabilit√©** | ‚ùå N√©cessite un navigateur | ‚úÖ Fichier unique, lisible partout |
| **Impression** | ‚ùå Mise en page variable | ‚úÖ Pagination professionnelle |
| **Graphes** | ‚úÖ Interactifs (zoomables) | ‚ö†Ô∏è Statiques |
| **Taille** | ‚ö†Ô∏è Plusieurs fichiers | ‚úÖ Un seul fichier |
| **G√©n√©ration** | ‚úÖ Rapide (secondes) | ‚ö†Ô∏è Plus lente (minutes) |
| **H√©bergement web** | ‚úÖ GitHub Pages, etc. | ‚ùå N√©cessite t√©l√©chargement |

**Recommandation** : G√©n√©rez **toujours le HTML** (c'est le plus pratique). G√©n√©rez le PDF uniquement si vous avez besoin d'un document imprimable ou √† distribuer hors ligne.

---

## V√©rification et tests

### Checklist avant de partager votre documentation

‚úÖ V√©rifiez que tous les fichiers importants sont document√©s :
```bash
# Lister les fichiers sans documentation
grep -r "^[^/]*function\|^struct" src/ --include="*.c" --include="*.h" | \
  grep -v "/\*\*"
```

‚úÖ Assurez-vous qu'il n'y a pas de warnings Doxygen :
```bash
doxygen 2>&1 | grep -i warning
```

‚úÖ Testez les liens internes (tous les `@see` doivent pointer vers quelque chose qui existe)

‚úÖ V√©rifiez l'apparence sur diff√©rents navigateurs (Chrome, Firefox)

---

## Astuces de pro

### 1. Documentation incr√©mentale

Ne g√©n√©rez pas toute la doc √† chaque modification. Utilisez l'option `INCREMENTAL_INCLUDE_PATH` :

```bash
INCREMENTAL_DOXYGEN    = YES
```

Doxygen ne r√©g√©n√©rera que les fichiers modifi√©s.

### 2. Documentation multilingue

Pour supporter plusieurs langues, cr√©ez plusieurs `Doxyfile` :

```
Doxyfile.fr  (OUTPUT_LANGUAGE = French)
Doxyfile.en  (OUTPUT_LANGUAGE = English)
```

Et g√©n√©rez :

```bash
doxygen Doxyfile.fr
doxygen Doxyfile.en
```

### 3. Avertissement sur le code non document√©

Forcez la documentation compl√®te :

```bash
WARN_IF_UNDOCUMENTED   = YES
WARN_IF_DOC_ERROR      = YES
```

Doxygen affichera des avertissements pour tout code sans commentaire.

---

## D√©pannage courant

### "warning: no output generated"

**Cause** : Aucun fichier source trouv√©.

**Solution** : V√©rifiez `INPUT` et `FILE_PATTERNS` dans le Doxyfile.

### Les graphes ne s'affichent pas

**Cause** : Graphviz n'est pas install√© ou `HAVE_DOT = NO`.

**Solution** :
```bash
sudo apt install graphviz
# Puis dans Doxyfile : HAVE_DOT = YES
```

### Documentation vide ou incompl√®te

**Cause** : `EXTRACT_ALL = NO` et peu de commentaires Doxygen.

**Solution** : Mettez `EXTRACT_ALL = YES` pour documenter m√™me sans commentaires sp√©ciaux.

### Erreur "fatal error: opening file 'input.tex' for writing"

**Cause** : Permissions insuffisantes dans le dossier `docs/latex/`.

**Solution** :
```bash
chmod -R 755 docs/
```

---

## Ressources et documentation officielle

- **Site officiel Doxygen** : https://www.doxygen.nl/
- **Manuel complet** : https://www.doxygen.nl/manual/
- **Liste des options du Doxyfile** : https://www.doxygen.nl/manual/config.html
- **FAQ** : https://www.doxygen.nl/manual/faq.html

---

## R√©sum√© des commandes essentielles

```bash
# Cr√©er un Doxyfile
doxygen -g

# G√©n√©rer la documentation (HTML + LaTeX)
doxygen

# Compiler le PDF
cd docs/latex && make

# Voir la doc HTML
xdg-open docs/html/index.html

# Voir le PDF
xdg-open docs/latex/refman.pdf

# Servir la doc en local
cd docs/html && python3 -m http.server 8000
```

---

## Conclusion

Vous savez maintenant :
1. ‚úÖ Installer Doxygen
2. ‚úÖ Cr√©er et configurer un `Doxyfile`
3. ‚úÖ G√©n√©rer de la documentation HTML (le format le plus courant)
4. ‚úÖ G√©n√©rer de la documentation PDF (pour impression/distribution)
5. ‚úÖ Personnaliser l'apparence et le contenu
6. ‚úÖ Automatiser et int√©grer dans votre workflow

La documentation est un **investissement**, pas une perte de temps. Un projet bien document√© attire plus de contributeurs, facilite la maintenance, et vous fait gagner du temps √† long terme.

Dans la prochaine section (32.1.3), nous verrons comment **int√©grer la g√©n√©ration de documentation dans votre pipeline CI/CD** pour qu'elle soit toujours √† jour automatiquement.

---

**Prochaines √©tapes recommand√©es :**
1. Documentez un petit projet personnel avec Doxygen
2. G√©n√©rez la doc HTML et partagez-la avec GitHub Pages
3. Explorez les th√®mes CSS personnalis√©s pour rendre votre doc unique

‚è≠Ô∏è [Int√©gration dans le CI](/32-documentation-maintenance/01.3-integration-ci.md)
