üîù Retour au [Sommaire](/SOMMAIRE.md)

# 1.3.2 V√©rification du support compilateur

## Introduction

Avant de commencer √† programmer en C, il est essentiel de savoir **quel compilateur** vous avez sur votre syst√®me et **quelles versions du standard C** il supporte. Cela vous √©vitera des surprises et des erreurs difficiles √† comprendre.

Dans cette section, nous allons apprendre √† :
- Identifier les compilateurs install√©s sur votre Ubuntu
- V√©rifier leurs versions
- Tester le support des diff√©rents standards C (C99, C11, C17, C23)
- Comprendre les options de compilation
- Installer des versions alternatives si n√©cessaire

> üí° **Rassurez-vous** : Cette section peut sembler technique, mais nous allons proc√©der pas √† pas. Vous n'avez besoin d'aucune connaissance pr√©alable en ligne de commande !

---

## üñ•Ô∏è Les compilateurs C disponibles sur Ubuntu

### Les deux compilateurs principaux

Sur Ubuntu (et Linux en g√©n√©ral), vous avez principalement deux compilateurs C :

| Compilateur | Description | Origine |
|-------------|-------------|---------|
| **GCC** | GNU Compiler Collection | Projet GNU (Free Software Foundation) |
| **Clang** | C Language Family Frontend | LLVM Project (Apple, Google, etc.) |

**GCC** est g√©n√©ralement install√© par d√©faut sur Ubuntu. **Clang** peut √™tre install√© facilement si besoin.

### Lequel utiliser ?

**Pour d√©buter : GCC**
- Install√© par d√©faut
- Excellent support de tous les standards C
- Documentation abondante
- Messages d'erreur compr√©hensibles

**Clang est une alternative int√©ressante** pour :
- Messages d'erreur encore plus clairs
- Compilation parfois plus rapide
- Certaines fonctionnalit√©s avanc√©es

> üéØ **Recommandation** : Commencez avec GCC. Une fois √† l'aise, vous pourrez essayer Clang pour comparer.

---

## üîç V√©rifier GCC

### √âtape 1 : V√©rifier si GCC est install√©

Ouvrez un terminal (Ctrl+Alt+T sur Ubuntu) et tapez :

```bash
gcc --version
```

**R√©sultat typique sur Ubuntu 24.04** :
```
gcc (Ubuntu 13.2.0-23ubuntu4) 13.2.0
Copyright (C) 2023 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
```

**Interpr√©tation** :
- **Premi√®re ligne** : Version de GCC = `13.2.0`
- **Ubuntu 13.2.0-23ubuntu4** : Version packag√©e pour Ubuntu
- Vous avez GCC install√© ! ‚úÖ

### Si GCC n'est pas install√©

Si vous voyez `gcc: command not found`, installez-le :

```bash
sudo apt update
sudo apt install build-essential
```

Le paquet `build-essential` installe :
- GCC (compilateur C)
- G++ (compilateur C++)
- make (outil de build)
- libc-dev (biblioth√®ques de d√©veloppement)

> üí° **sudo** : Commande pour ex√©cuter avec les droits administrateur. Ubuntu vous demandera votre mot de passe.

### √âtape 2 : Identifier le standard C par d√©faut

Chaque version de GCC a un standard C par d√©faut. Voici un tableau de correspondance :

| Version GCC | Standard par d√©faut | Ann√©e de sortie |
|-------------|---------------------|-----------------|
| GCC 4.x | `gnu90` (bas√© sur C89/C90) | ~2005-2015 |
| GCC 5.x | `gnu11` (bas√© sur C11) | 2015 |
| GCC 6-13 | `gnu17` (bas√© sur C17) | 2016-2023 |
| GCC 14+ | `gnu17` ou `gnu23` | 2024+ |

> ‚ö†Ô∏è **Note** : `gnu11`, `gnu17` = C11/C17 + extensions GNU. On verra la diff√©rence plus bas.

**Pour conna√Ætre le standard par d√©faut** :

```bash
gcc -dM -E - < /dev/null | grep __STDC_VERSION__
```

**R√©sultat possible** :
```
#define __STDC_VERSION__ 201710L
```

**D√©codage** :
- `201710L` = C17 (publi√© en 2017-10)
- `201112L` = C11 (publi√© en 2011-12)
- `199901L` = C99 (publi√© en 1999-01)
- `202311L` = C23 (publi√© en 2023-11)

### √âtape 3 : Tester le support de chaque standard

Cr√©ons un petit programme test pour v√©rifier les standards support√©s.

**Cr√©ez un fichier `test_std.c`** :

```c
#include <stdio.h>

int main(void) {
    #ifdef __STDC_VERSION__
        printf("Standard C d√©tect√© : ");

        #if __STDC_VERSION__ == 199901L
            printf("C99\n");
        #elif __STDC_VERSION__ == 201112L
            printf("C11\n");
        #elif __STDC_VERSION__ == 201710L
            printf("C17\n");
        #elif __STDC_VERSION__ == 202311L
            printf("C23\n");
        #else
            printf("Version : %ld\n", __STDC_VERSION__);
        #endif
    #else
        printf("C90 ou ant√©rieur\n");
    #endif

    return 0;
}
```

**Testez diff√©rents standards** :

```bash
# C89/C90
gcc -std=c90 test_std.c -o test_std && ./test_std

# C99
gcc -std=c99 test_std.c -o test_std && ./test_std

# C11
gcc -std=c11 test_std.c -o test_std && ./test_std

# C17
gcc -std=c17 test_std.c -o test_std && ./test_std

# C23 (si support√©)
gcc -std=c23 test_std.c -o test_std && ./test_std
```

**R√©sultats attendus** :
```
Standard C d√©tect√© : C99
Standard C d√©tect√© : C11
Standard C d√©tect√© : C17
Standard C d√©tect√© : C23
```

> üí° Si C23 √©choue avec une erreur, c'est normal ! Cela signifie simplement que votre version de GCC ne le supporte pas encore compl√®tement.

---

## üîç V√©rifier Clang

### √âtape 1 : V√©rifier si Clang est install√©

```bash
clang --version
```

**R√©sultat typique** :
```
Ubuntu clang version 18.1.3 (1ubuntu1)
Target: x86_64-pc-linux-gnu
Thread model: posix
InstalledDir: /usr/bin
```

### Si Clang n'est pas install√©

```bash
sudo apt update
sudo apt install clang
```

Pour une version sp√©cifique (exemple : Clang 18) :

```bash
sudo apt install clang-18
```

### Tester avec Clang

Utilisez le m√™me fichier `test_std.c` :

```bash
# C11
clang -std=c11 test_std.c -o test_std && ./test_std

# C17
clang -std=c17 test_std.c -o test_std && ./test_std

# C23
clang -std=c23 test_std.c -o test_std && ./test_std
```

---

## üìã Tableau de compatibilit√© GCC/Clang

### Support des standards C

| Standard | GCC min. | Clang min. | Disponibilit√© |
|----------|----------|------------|---------------|
| **C90/C89** | Toutes versions | Toutes versions | ‚úÖ Universel |
| **C99** | GCC 3.0+ (2001) | Clang 3.0+ (2011) | ‚úÖ Universel |
| **C11** | GCC 4.6+ (2011) | Clang 3.1+ (2012) | ‚úÖ Universel |
| **C17** | GCC 8.0+ (2018) | Clang 6.0+ (2018) | ‚úÖ Universel |
| **C23** | GCC 14+ (2024) | Clang 18+ (2024) | üü° Partiel |

### Versions Ubuntu et compilateurs

| Ubuntu | Ann√©e | GCC par d√©faut | Clang disponible |
|--------|-------|----------------|------------------|
| 20.04 LTS | 2020 | GCC 9.4 | Clang 10-12 |
| 22.04 LTS | 2022 | GCC 11.4 | Clang 13-15 |
| 23.10 | 2023 | GCC 13.2 | Clang 16-17 |
| 24.04 LTS | 2024 | GCC 13.2 | Clang 18 |
| 24.10 | 2024 | GCC 14.x | Clang 18-19 |

> üéØ **Conclusion** : Si vous √™tes sur Ubuntu 22.04 ou plus r√©cent, vous avez **un excellent support de C11 et C17**.

---

## üß™ Tests de fonctionnalit√©s sp√©cifiques

### Test 1 : Support des threads (C11)

**Cr√©ez `test_threads.c`** :

```c
#include <stdio.h>
#include <threads.h>  // C11

int thread_func(void *arg) {
    printf("Thread C11 fonctionne !\n");
    return 0;
}

int main(void) {
    thrd_t thread;
    thrd_create(&thread, thread_func, NULL);
    thrd_join(thread, NULL);
    return 0;
}
```

**Compilation** :

```bash
gcc -std=c11 test_threads.c -o test_threads -pthread
./test_threads
```

> ‚ö†Ô∏è **Note** : Certaines impl√©mentations de glibc n'incluent pas `<threads.h>`. Si √ßa √©choue, c'est un probl√®me de biblioth√®que, pas de compilateur. Utilisez plut√¥t `pthread.h` (POSIX threads).

### Test 2 : Support des atomics (C11)

**Cr√©ez `test_atomics.c`** :

```c
#include <stdio.h>
#include <stdatomic.h>  // C11

int main(void) {
    atomic_int counter = ATOMIC_VAR_INIT(0);
    atomic_fetch_add(&counter, 5);
    printf("Compteur atomique : %d\n", atomic_load(&counter));
    return 0;
}
```

**Compilation** :

```bash
gcc -std=c11 test_atomics.c -o test_atomics
./test_atomics
```

**R√©sultat attendu** :
```
Compteur atomique : 5
```

### Test 3 : Support de `_Generic` (C11)

**Cr√©ez `test_generic.c`** :

```c
#include <stdio.h>

#define print_type(x) _Generic((x), \
    int: "int", \
    float: "float", \
    double: "double", \
    char *: "string", \
    default: "unknown" \
)

int main(void) {
    printf("Type de 42 : %s\n", print_type(42));
    printf("Type de 3.14f : %s\n", print_type(3.14f));
    printf("Type de \"Hello\" : %s\n", print_type("Hello"));
    return 0;
}
```

**Compilation** :

```bash
gcc -std=c11 test_generic.c -o test_generic
./test_generic
```

**R√©sultat** :
```
Type de 42 : int
Type de 3.14f : float
Type de "Hello" : string
```

### Test 4 : Nouveaut√©s C23 (si support√©)

**Cr√©ez `test_c23.c`** :

```c
#include <stdio.h>

// Test des attributs C23
[[nodiscard]] int compute(int x) {
    return x * 2;
}

int main(void) {
    // Constantes binaires C23
    int flags = 0b1010;

    // nullptr C23
    int *ptr = nullptr;

    printf("Flags : %d\n", flags);
    printf("Pointer is null : %s\n", ptr == nullptr ? "oui" : "non");

    return 0;
}
```

**Compilation** :

```bash
gcc -std=c23 test_c23.c -o test_c23
./test_c23
```

Si √ßa fonctionne ‚Üí Vous avez C23 ! üéâ
Si erreur ‚Üí Votre GCC ne supporte pas encore compl√®tement C23.

---

## üõ†Ô∏è Options de compilation importantes

### `-std=` : Choisir le standard

| Option | Description |
|--------|-------------|
| `-std=c90` ou `-std=c89` | C89/C90 strict |
| `-std=c99` | C99 strict |
| `-std=c11` | C11 strict |
| `-std=c17` | C17 strict |
| `-std=c23` | C23 strict (si support√©) |
| `-std=gnu90` | C90 + extensions GNU |
| `-std=gnu99` | C99 + extensions GNU |
| `-std=gnu11` | C11 + extensions GNU |
| `-std=gnu17` | C17 + extensions GNU |
| `-std=gnu23` | C23 + extensions GNU |

**Diff√©rence** :
- **Standard strict** (`c11`) : Respecte strictement la norme ISO
- **Avec extensions GNU** (`gnu11`) : Ajoute des fonctionnalit√©s GNU (plus flexible)

**Exemple** :

```bash
# Strict C11 (erreur si on utilise des extensions GNU)
gcc -std=c11 -pedantic program.c -o program

# C11 + extensions GNU (plus permissif)
gcc -std=gnu11 program.c -o program
```

### `-pedantic` : Mode strict

Active les avertissements pour le code non-standard :

```bash
gcc -std=c11 -pedantic -Wall -Wextra program.c -o program
```

**Pourquoi utiliser `-pedantic` ?**
- Code plus portable
- Respecte strictement la norme
- √âvite les d√©pendances aux extensions sp√©cifiques

### V√©rifier les macros pr√©d√©finies

Pour voir toutes les macros d√©finies par le compilateur :

```bash
gcc -dM -E - < /dev/null
```

**Macros importantes** :

| Macro | Signification |
|-------|---------------|
| `__STDC__` | Compilateur conforme au standard C |
| `__STDC_VERSION__` | Version du standard (199901L, 201112L, etc.) |
| `__GNUC__` | Version majeure de GCC |
| `__clang__` | D√©fini si compilateur Clang |
| `__linux__` | Syst√®me Linux |
| `__x86_64__` | Architecture 64 bits |

**Exemple d'utilisation dans le code** :

```c
#include <stdio.h>

int main(void) {
    #ifdef __GNUC__
        printf("Compil√© avec GCC %d.%d.%d\n",
               __GNUC__, __GNUC_MINOR__, __GNUC_PATCHLEVEL__);
    #endif

    #ifdef __clang__
        printf("Compil√© avec Clang\n");
    #endif

    printf("Version C : %ld\n", __STDC_VERSION__);

    return 0;
}
```

---

## üì¶ Installer plusieurs versions de GCC

### Pourquoi avoir plusieurs versions ?

- Tester la compatibilit√©
- Utiliser des fonctionnalit√©s r√©centes (C23)
- Travailler avec du code legacy (ancien)

### Installation de GCC 14 (pour C23)

Sur Ubuntu 24.04+ :

```bash
sudo apt update
sudo apt install gcc-14 g++-14
```

### Utiliser une version sp√©cifique

**M√©thode 1 : Appel direct**

```bash
gcc-14 -std=c23 program.c -o program
```

**M√©thode 2 : Alternatives syst√®me**

```bash
# Installer gcc-14 comme alternative
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-14 100
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-13 90

# Choisir la version √† utiliser
sudo update-alternatives --config gcc
```

**Interface de s√©lection** :
```
Il existe 2 choix pour l'alternative gcc.

  S√©lection   Chemin              Priorit√©  √âtat
------------------------------------------------------------
* 0            /usr/bin/gcc-14     100       mode automatique
  1            /usr/bin/gcc-13     90        mode manuel
  2            /usr/bin/gcc-14     100       mode manuel

Appuyez sur <Entr√©e> pour conserver la valeur par d√©faut[*] ou choisissez le num√©ro s√©lectionn√© :
```

### V√©rifier la version active

```bash
gcc --version
which gcc
```

---

## üéØ Recommandations pratiques

### Pour les d√©butants (vous !)

**Configuration recommand√©e** :
- **Ubuntu 22.04 LTS ou plus r√©cent**
- **GCC 11+ ou GCC 13+** (install√© par d√©faut)
- **Standard cible : C11 ou C17**

**Commande de compilation √† utiliser** :

```bash
gcc -std=c11 -Wall -Wextra -Werror -pedantic program.c -o program
```

**Explication des options** :
- `-std=c11` : Utilise le standard C11
- `-Wall` : Active tous les warnings standards
- `-Wextra` : Active des warnings suppl√©mentaires
- `-Werror` : Traite les warnings comme des erreurs (code plus propre)
- `-pedantic` : Mode strict conforme √† la norme

### Pour les projets professionnels

**Configuration conservatrice** :
```bash
gcc -std=c99 -Wall -Wextra -O2 program.c -o program
```
- C99 pour compatibilit√© maximale
- `-O2` pour optimisations

**Configuration moderne** :
```bash
gcc -std=c17 -Wall -Wextra -O2 -g program.c -o program
```
- C17 (version corrig√©e de C11)
- `-g` pour symboles de d√©bogage

---

## üß™ Script de v√©rification automatique

Cr√©ez un script `check_compiler.sh` pour tout v√©rifier automatiquement :

```bash
#!/bin/bash

echo "=== V√©rification du compilateur C ==="
echo

# V√©rifier GCC
echo "1. GCC"
if command -v gcc &> /dev/null; then
    gcc --version | head -n1
    echo "   Standard par d√©faut :"
    gcc -dM -E - < /dev/null | grep __STDC_VERSION__
else
    echo "   GCC non install√© ‚ùå"
fi

echo

# V√©rifier Clang
echo "2. Clang"
if command -v clang &> /dev/null; then
    clang --version | head -n1
else
    echo "   Clang non install√© ‚ùå"
fi

echo

# Tester les standards C
echo "3. Support des standards C (GCC)"
for std in c90 c99 c11 c17 c23; do
    if gcc -std=$std -xc - -o /dev/null <<< "int main(){}" 2>/dev/null; then
        echo "   $std : ‚úÖ"
    else
        echo "   $std : ‚ùå"
    fi
done

echo
echo "=== V√©rification termin√©e ==="
```

**Utilisation** :

```bash
chmod +x check_compiler.sh
./check_compiler.sh
```

**R√©sultat typique** :
```
=== V√©rification du compilateur C ===

1. GCC
gcc (Ubuntu 13.2.0-23ubuntu4) 13.2.0
   Standard par d√©faut :
#define __STDC_VERSION__ 201710L

2. Clang
Ubuntu clang version 18.1.3 (1ubuntu1)

3. Support des standards C (GCC)
   c90 : ‚úÖ
   c99 : ‚úÖ
   c11 : ‚úÖ
   c17 : ‚úÖ
   c23 : üü° (partiel)

=== V√©rification termin√©e ===
```

---

## üéì Ce que vous devez retenir

### Les points essentiels

1. **GCC est le compilateur principal** sur Ubuntu (g√©n√©ralement install√© par d√©faut)
2. **V√©rifier la version** : `gcc --version`
3. **V√©rifier le standard** : `gcc -dM -E - < /dev/null | grep __STDC_VERSION__`
4. **Ubuntu r√©cent = bon support C11/C17** (GCC 11+)
5. **C23 n√©cessite GCC 14+** (support partiel en 2025)

### Commandes √† retenir

```bash
# V√©rifier GCC
gcc --version

# Compiler avec C11 (recommand√©)
gcc -std=c11 -Wall -Wextra program.c -o program

# Compiler avec C17 (version corrig√©e de C11)
gcc -std=c17 -Wall -Wextra program.c -o program

# Mode strict
gcc -std=c11 -pedantic -Wall -Wextra program.c -o program
```

### Configuration recommand√©e pour apprendre

**Sur Ubuntu 22.04 LTS ou plus r√©cent** :
- GCC 11+ (d√©j√† install√©)
- Standard cible : **C11 ou C17**
- Options : `-Wall -Wextra -pedantic`

**Vous √™tes pr√™t(e) !** üöÄ

---

## üîú Prochaine √©tape

Maintenant que vous avez v√©rifi√© votre compilateur, passons √† la section suivante :

- **1.3.3** : Pourquoi C11 reste la base recommand√©e en production

Vous allez comprendre pourquoi, malgr√© l'existence de C23, nous allons principalement utiliser C11/C17 dans ce tutoriel.

---

## üìñ Ressources compl√©mentaires

### Documentation officielle

- [GCC Online Documentation](https://gcc.gnu.org/onlinedocs/)
- [GCC Standards Support](https://gcc.gnu.org/projects/cxx-status.html)
- [Clang Language Extensions](https://clang.llvm.org/docs/LanguageExtensions.html)

### Man pages utiles

```bash
man gcc        # Documentation GCC
man clang      # Documentation Clang
info gcc       # Manuel complet GCC (format Info)
```

### Communaut√©s d'aide

- [Stack Overflow](https://stackoverflow.com/questions/tagged/gcc) - Tag [gcc]
- [r/C_Programming](https://reddit.com/r/C_Programming)
- [GCC Mailing Lists](https://gcc.gnu.org/lists.html)

---

**F√©licitations ! Vous savez maintenant v√©rifier et configurer votre environnement de compilation C.** üéâ

‚è≠Ô∏è [Pourquoi C11 reste la base recommand√©e en production](/01-ecosysteme-c-linux/03.3-c11-base-production.md)
